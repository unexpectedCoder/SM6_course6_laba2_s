# Лабораторная работа №2: "Дискретно-событийное моделирование на примере задачи вулканической баллистики"

---

## Задача

Смоделировать процесс разлёта камней из кратера вулкана при его извержении, получив в результате координаты точек падения камней на плоскость $z=0$. Пространство трёхмерно, оси $Ox$ и $Oy$ лежат в горизонтальной плоскости, ось $Oz$ направлена вертикально вверх

Проанализировать результаты моделирования, когда столкновения между камнями учитываются и когда не учитываются. Использовать дискретно-событийный подход.

**Цель** - закрепить знания и получить опыт решения физической задачи путём компьютерного моделирования с применением дискретно-событийного подхода.

**Задачи**:

1. Создать компьютерную модель процесса извержения вулкана. Реализовать возможность моделирования как без, так и с возможностью столкновения между камнями.
2. Составить отчёт по ЛР (форма отчёта та же: титульный лист, теория, практика и т. д.), в котором привести значения параметров модели, полученные результаты в виде графика аналогичного графику, показанному на лекциях, а также анализ полученных результатов.

Процесс извержения характеризуется следующими параметрами:

* $R_c$ - радиус кратера.
* $D_c$ - глубина кратера.
* $H > 0$ - высота кратера.
* $\mu_s$ и $\sigma_s$ - параметры нормального распределения скорости камней: $s = \|\vec v\| \sim \mathcal{N}(\mu_s, \sigma_s)$.
* $\varphi \in [0, 2\pi]$ - диапазон разлёта бомб по углу азимута.
* $\mu_\theta$ и $\sigma_\theta$ - параметры нормального распределения угла возвышения для вектора скорости камней: $\theta \sim \mathcal{N}(\mu_\theta, \sigma_\theta)$.
* $R_{min}$ и $R_{max}$ - минимальный и максимальный радиусы бомб. Распределение величины радиуса камня - равномерное.
* $\rho$ - плотность материала камней.
* $\beta_{erup}$ - среднее время между извержениями. Случайная величина временного промежутка между извержениями $\Delta t_{erup}$ распределена по экспоненциальному закону с параметром $\beta_{erup}$.
  
При извержении новые бомбы добавляются в список `flyings`.
При приземлении камень убирается из списка `flyings` и добавляется в список приземлившихся `fallens`.

## Методические указания

### Модель камня (бомбы)

Бомба имеет форму шара радиуса $R$, массу $m$, радиус-вектор положения $\vec r$ и вектор скорости $\vec v$.

Значения векторов $\vec v$ и $\vec r$ - это значения в момент времени, когда камень извергся или столкнулся с другим.

Также камень может хранить флаг `is_collided`, указывающий на то, сталкивался ли камень (`True`) или нет (`False`).

### Модель процесса извержения (разлёта камней)

Траектория каждого камня описывается законом движения свободно падающего тела:

$$
\vec r(t) = \frac{1}{2}\vec g t^2 + \vec v(0) t + \vec r(0),
$$

где $\vec g = (0, 0, -9.82)\ {\rm м/с}^2$ - вектор ускорения свободного падения.

### Извержение

Процесс характеризуется средним временем $t_{erup}$ наступления события `извержение` и числом $n$ выбрасываемых при этом камней.

Случайная величина времени между двумя соседними извержениями распределена по экспоненциальному закону.

При извержении (событие `ERUPTION`)

1. Генерируются новые бомбы.
2. Рассчитывается время $t_g$ их падения на землю, т.е. достижение высоты $z=0$.
3. Для каждой новой бомбы рассчитывается ближайший момент времени $t_c$, когда она столкнётся с любой бомбой из списка `flyings`.
4. После этого новая бомба добавляется в список `flyings`.

### Столкновение

При столкновении двух бомб $B_1$ и $B_2$ (событие `COLLISION`)

1. Очищается очередь событий, связанных с $B_1$ и $B_2$.
2. Обновляются векторы начальных скоростей $\vec v^{B_1}(0)$ и $\vec v^{B_2}(0)$ и радиус-векторы начального положения $\vec r^{B_1}(0)$ и $\vec r^{B_2}(0)$ бомб $B_1$ и $B_2$.
3. Пересчитывается время падения $B_1$ и $B_2$.
4. Пересчитываются моменты времени столкновения $B_1$ и $B_2$ с другими камнями из списка `flyings`.

#### Условие столкновения камней

Камни 1 и 2 сталкиваются, если расстояние $d$ между их центрами меньше суммы их радиусов $R_1$ и $R_2$, т. е.

$$
d(t)
    = \| \vec r_1(t) - \vec r_2(t) \|
    = \| \Delta\vec v t + \Delta\vec r \|
    \le R_1 + R_2.
$$

Производные по времени:
$\dot{d}(t) = \| \Delta \vec v \| = \Delta s$ и
$\ddot{d}(t) = 0$.

#### Расчёт скоростей после столкновения

Скорость сближения тел в момент удара

$$v_c = -\left( \vec v_1 - \vec v_2 \right) \cdot \vec n,$$

где вектор единичной нормали при столкновении

$$\vec n = \cfrac{\vec r_1 - \vec r_2}{\| \vec r_1 - \vec r_2 \|}.$$

Скорость разлёта тел до столкновения

$$v_s = -v_c$$

и после

$$\vec v_s' = -c v_s,$$

где $c \in [0, 1]$ - коэффициент восстановления.

Изменение скорости при ударе

$$\Delta v_s = v_s' - v_s.$$

Тогда вектор импульса есть

$$\vec p = \cfrac{m_1 m_2}{m_1 + m_2} \Delta v_s \vec n.$$

Следовательно, возможно рассчитать скорость каждого тела после столкновения:

$$\vec v_1' = \vec v_1 + \cfrac{\vec p}{m_1},$$

$$\vec v_2' = \vec v_2 - \cfrac{\vec p}{m_2}.$$

### Приземление

При приземлении камня (событие `GROUND`)

1. Очищается очередь событий, связанных с этим камнем.
2. Камень переносится из списка `flyings` в список `fallens`.
